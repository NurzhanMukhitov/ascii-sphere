<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <!-- Адаптивность -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UNIVERSEDESIGN - Adaptive Cube with Logo (Right Corner)</title>
  <style>
    /* Подключаем кастомный шрифт OneDay */
    @font-face {
      font-family: 'OneDay';
      src: url('fonts/ONEDAY.woff') format('woff');
      font-weight: normal;
      font-style: normal;
    }

    /* Сброс стилей */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      width: 100vw; 
      height: 100vh;
      background: black; 
      color: white;
      overflow: hidden; 
      position: relative;
      font-family: 'OneDay', monospace;
    }
    canvas {
      display: block;
      margin: 0 auto;
    }

    /* Гамбургер (3 полоски) – изначально скрыт */
    #menu-btn {
      position: absolute;
      top: 20px;
      left: 20px;  /* Гамбургер слева */
      width: 40px;
      height: 30px;
      cursor: pointer;
      display: none; /* Появляется, когда куб собран (tParam<0.1) */
      z-index: 1000;
    }
    #menu-btn span {
      display: block;
      width: 100%;
      height: 4px;
      background: white;
      margin: 4px 0;
    }

    /* Логотип (UNIVERSE design) – в правом верхнем углу, появляется при tParam<0.1 */
    #logo-text {
      position: absolute;
      top: 25px;
      right: 20px;   /* Логотип в правом верхнем углу */
      font-size: 24px;
      cursor: pointer;
      display: none; /* Появится, когда куб собран */
      z-index: 1000;
      text-align: right;
      line-height: 1.1; /* чтобы "design" было чуть ближе к "UNIVERSE" */
    }

    /* Меню-оверлей – изначально скрыт, открывается по клику на гамбургер */
    #menu-overlay {
      position: absolute;
      top: 60px;
      left: 20px;
      width: 220px;
      background: rgba(0, 0, 0, 0.8);
      padding: 10px;
      display: none;
      z-index: 1000;
    }
    #menu-overlay img {
      display: block;
      margin: 0 auto 10px auto;
      max-width: 200px;
    }
    #menu-overlay ul {
      list-style: none;
      margin: 0; 
      padding: 0;
    }
    #menu-overlay li {
      margin: 10px 0;
      cursor: pointer;
    }

    /* Общий оверлей для ABOUT, CONTACTS, PROJECTS */
    .overlay {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      display: none;
      z-index: 1000;
    }
    .overlay-container {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 600px;
      max-width: 90%;
      background: rgba(0,0,0,0.9);
      padding: 20px;
      border: 1px solid white;
      color: white;
    }
    .close-btn {
      cursor: pointer;
      color: #aaa;
      float: right;
      margin-left: 10px;
    }
    .projects-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-gap: 10px;
    }
    .project-item {
      background: #222;
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #ccc;
      font-size: 14px;
      border: 1px solid #444;
      cursor: pointer;
    }

    /* Медиа-запросы для адаптивности */
    @media screen and (max-width: 575px) {
      #menu-btn {
        width: 35px; height: 25px;
      }
      #menu-btn span {
        height: 3px; margin: 3px 0;
      }
      #logo-text {
        top: 25px; right: 15px; font-size: 18px;
      }
      #menu-overlay {
        width: 180px; top: 50px; left: 10px;
      }
      .overlay-container {
        width: 90%;
        padding: 15px;
      }
    }
    @media screen and (min-width: 576px) and (max-width: 767px) {
      #logo-text {
        font-size: 20px;
      }
      #menu-overlay {
        width: 200px; top: 60px; left: 15px;
      }
    }
    @media screen and (min-width: 768px) and (max-width: 991px) {
      #logo-text {
        font-size: 22px;
      }
      #menu-overlay {
        width: 220px; top: 60px; left: 20px;
      }
    }
    @media screen and (min-width: 992px) and (max-width: 1199px) {
      #logo-text {
        font-size: 24px;
      }
      #menu-overlay {
        width: 240px; top: 70px; left: 20px;
      }
    }
    @media screen and (min-width: 1200px) and (max-width: 1399px) {
      #logo-text {
        font-size: 26px;
      }
      #menu-overlay {
        width: 260px; top: 80px; left: 20px;
      }
    }
    @media screen and (min-width: 1400px) {
      #logo-text {
        font-size: 28px;
      }
      #menu-overlay {
        width: 280px; top: 80px; left: 20px;
      }
    }
  </style>
</head>
<body>
<canvas id="canvas"></canvas>

<!-- Гамбургер -->
<div id="menu-btn">
  <span></span>
  <span></span>
  <span></span>
</div>

<!-- Логотип (UNIVERSE design) в правом верхнем углу -->
<div id="logo-text">UNIVERSE<br>design</div>

<!-- Меню-оверлей -->
<div id="menu-overlay">
  <img id="menu-logo" src="logo/UNIVERSE.png" alt="Logo">
  <ul>
    <!-- Убрали HOME, есть логотип -->
    <li id="about-link">ABOUT</li>
    <li id="projects-link">PROJECTS</li>
    <li id="contacts-link">CONTACTS</li>
  </ul>
</div>

<!-- ABOUT -->
<div id="about-overlay" class="overlay">
  <div class="overlay-container">
    <span class="close-btn" id="about-close">[x]</span>
    <h2>About</h2>
    <p>
      We are design studio passionate about technology research,
      media art and installation/exhibition design.
    </p>
  </div>
</div>

<!-- CONTACTS -->
<div id="contacts-overlay" class="overlay">
  <div class="overlay-container">
    <span class="close-btn" id="contacts-close">[x]</span>
    <h2>Contacts</h2>
    <p>
      <a href="https://www.behance.net/dimahoc" target="_blank" style="color: #ccc;">BEHANCE</a><br>
      <a href="https://www.instagram.com/universe_design_studio?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==" target="_blank" style="color: #ccc;">INSTAGRAM</a>
    </p>
  </div>
</div>

<!-- PROJECTS -->
<div id="projects-overlay" class="overlay">
  <div class="overlay-container">
    <span class="close-btn" id="projects-close">[x]</span>
    <h2>Projects</h2>
    <div class="projects-grid">
      <div class="project-item">Project 1</div>
      <div class="project-item">Project 2</div>
      <div class="project-item">Project 3</div>
      <div class="project-item">Project 4</div>
      <div class="project-item">Project 5</div>
      <div class="project-item">Project 6</div>
    </div>
  </div>
</div>

<script>
  /* ================== АДАПТИВНЫЙ РАЗМЕР КУБА ================== */
  function getCubeSize() {
    let w = window.innerWidth;
    // Примерная логика
    if (w < 576) return 200;
    if (w < 768) return 250;
    if (w < 992) return 300;
    if (w < 1200) return 350;
    if (w < 1400) return 400;
    return 450;
  }

  let canvas = document.getElementById("canvas");
  let ctx = canvas.getContext("2d");

  let tParam = 1;   // 1=хаос, 0=собранный куб
  let rotationX = 0, rotationY = 0;
  let isDragging = false, lastX=0, lastY=0, dragStartY=0;
  let gatherTriggered=false, scatterTriggered=false;
  let points = [];
  let autoRotateSpeed = 0.002;

  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  /* Генерация точек куба с учётом адаптивного размера */
  function generatePoints() {
    points = [];
    let cSize = getCubeSize(); 
    let half = cSize / 2;
    let linesX = 14, linesY = 14, pointsPerLine=10;
    let topZ = +half, botZ = -half;

    const letters = "UNIVERSEDESIGN";
    function randomScatter(){
      return {
        x: (Math.random()-0.5)*2000,
        y: (Math.random()-0.5)*2000,
        z: (Math.random()-0.5)*2000
      };
    }

    for(let j=0; j<linesY; j++){
      const fracY = j/(linesY-1);
      const yVal = -half + fracY*cSize;
      for(let i=0; i<linesX; i++){
        const fracX = i/(linesX-1);
        const xVal = -half + fracX*cSize;
        let char;
        if(j===linesY-1){
          char = letters[i % letters.length];
        } else {
          const rnd = Math.floor(Math.random()*letters.length);
          char = letters[rnd];
        }
        for(let k=0; k<pointsPerLine; k++){
          const fracZ = k/(pointsPerLine-1);
          const zVal = topZ*(1-fracZ) + botZ*fracZ;
          const cubePos = {x:xVal, y:yVal, z:zVal};
          const scatterPos = randomScatter();
          points.push({cubePos, scatterPos, char, i, j});
        }
      }
    }
  }

  generatePoints();

  /* При resize – пересоздаём canvas, заново генерируем точки (чтобы куб стал другого размера) */
  window.addEventListener("resize", ()=>{
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    let oldT = tParam;  
    let oldRX = rotationX, oldRY = rotationY;
    generatePoints();  
    tParam = oldT;
    rotationX = oldRX; rotationY = oldRY;
  });

  /* Управление мышью/тач */
  function startPointer(x,y){
    isDragging=true;
    lastX=x; lastY=y;
    dragStartY=y;
    gatherTriggered=false; scatterTriggered=false;
  }
  function movePointer(x,y){
    if(!isDragging) return;
    const dx=x-lastX, dy=y-lastY;
    rotationY+=dx*0.01; rotationX+=dy*0.01;
    lastX=x; lastY=y;
    const totalDy = y-dragStartY;
    if(!gatherTriggered && totalDy<-100 && tParam>0.5){
      gatherTriggered=true; animateGather();
    }
    if(!scatterTriggered && totalDy>100 && tParam<0.5){
      scatterTriggered=true; animateScatter();
    }
  }
  function endPointer(){ isDragging=false; }

  canvas.addEventListener("mousedown",(e)=>startPointer(e.clientX,e.clientY));
  canvas.addEventListener("mousemove",(e)=>movePointer(e.clientX,e.clientY));
  canvas.addEventListener("mouseup",endPointer);
  canvas.addEventListener("mouseleave",endPointer);
  canvas.addEventListener("touchstart",(e)=>{
    e.preventDefault();
    if(e.touches.length>0){
      let t=e.touches[0];
      startPointer(t.clientX,t.clientY);
    }
  },{passive:false});
  canvas.addEventListener("touchmove",(e)=>{
    e.preventDefault();
    if(e.touches.length>0){
      let t=e.touches[0];
      movePointer(t.clientX,t.clientY);
    }
  },{passive:false});
  canvas.addEventListener("touchend",(e)=>{
    e.preventDefault();
    endPointer();
  },{passive:false});
  canvas.addEventListener("wheel",(e)=>{
    e.preventDefault();
    const sensitivity=0.0005;
    let newT=tParam + e.deltaY*sensitivity;
    newT=Math.max(0,Math.min(1,newT));
    tParam=newT;
  },{passive:false});

  /* Анимация сборки */
  function animateGather(){
    const startTime=performance.now();
    const duration=2000;
    const initT=tParam;
    function step(){
      const now=performance.now();
      const elapsed=now - startTime;
      const alpha=elapsed/duration;
      if(alpha>=1){
        tParam=0;
        rotationX=-0.4; rotationY=0.5;
      } else {
        tParam=initT*(1-alpha);
        requestAnimationFrame(step);
      }
    }
    requestAnimationFrame(step);
  }
  /* Анимация разброса */
  function animateScatter(){
    const startTime=performance.now();
    const duration=2000;
    const initT=tParam;
    function step(){
      const now=performance.now();
      const elapsed=now - startTime;
      const alpha=elapsed/duration;
      if(alpha>=1){
        tParam=1;
      } else {
        tParam= initT + (1-initT)*alpha;
        requestAnimationFrame(step);
      }
    }
    requestAnimationFrame(step);
  }

  let autoRotateSpeed=0.002;
  function rotate3D(x,y,z,angleX,angleY){
    let cosX=Math.cos(angleX), sinX=Math.sin(angleX);
    let y1=y*cosX - z*sinX;
    let z1=y*sinX + z*cosX;
    y=y1; z=z1;
    let cosY=Math.cos(angleY), sinY=Math.sin(angleY);
    let x1=x*cosY + z*sinY;
    let z2=-x*sinY + z*cosY;
    x=x1; z=z2;
    return {x,y,z};
  }
  function project3D(x,y,z){
    const focal=500;
    const scale=focal/(focal+z);
    return {x:x*scale+canvas.width/2, y:y*scale+canvas.height/2};
  }
  function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    if(!isDragging){
      rotationY+=autoRotateSpeed;
    }
    // Показываем гамбургер и логотип, если куб собран
    const menuBtn=document.getElementById("menu-btn");
    const logoText=document.getElementById("logo-text");
    if(tParam<0.1){
      menuBtn.style.display="block";
      logoText.style.display="block";
    } else {
      menuBtn.style.display="none";
      logoText.style.display="none";
    }

    for(let p of points){
      const x0=(1-tParam)*p.cubePos.x + tParam*p.scatterPos.x;
      const y0=(1-tParam)*p.cubePos.y + tParam*p.scatterPos.y;
      const z0=(1-tParam)*p.cubePos.z + tParam*p.scatterPos.z;
      const rotated=rotate3D(x0,y0,z0,rotationX,rotationY);
      const proj=project3D(rotated.x,rotated.y,rotated.z);
      if(p.j===13 && tParam<0.1){
        ctx.fillStyle="white";
        ctx.font="bold 16px OneDay";
      } else {
        let bf=1 - (rotated.z+1000)/2000;
        bf=Math.max(0,Math.min(1,bf));
        let shade=Math.floor(128 + bf*127);
        ctx.fillStyle=`rgb(${shade},${shade},${shade})`;
        ctx.font="16px OneDay";
      }
      ctx.fillText(p.char, proj.x, proj.y);
    }
    requestAnimationFrame(draw);
  }
  requestAnimationFrame(draw);

  /* ========== МЕНЮ И ОВЕРЛЕИ ========== */
  const menuOverlay=document.getElementById("menu-overlay");
  const aboutOverlay=document.getElementById("about-overlay");
  const contactsOverlay=document.getElementById("contacts-overlay");
  const projectsOverlay=document.getElementById("projects-overlay");

  const aboutLink=document.getElementById("about-link");
  const projectsLink=document.getElementById("projects-link");
  const contactsLink=document.getElementById("contacts-link");

  const aboutClose=document.getElementById("about-close");
  const contactsClose=document.getElementById("contacts-close");
  const projectsClose=document.getElementById("projects-close");

  // Гамбургер – переключаем меню
  menuBtn.addEventListener("click", ()=>{
    if(menuOverlay.style.display==="block"){
      menuOverlay.style.display="none";
    } else {
      menuOverlay.style.display="block";
    }
  });

  // Логотип – при клике собираем куб
  logoText.addEventListener("click", ()=>{
    tParam=0;
    rotationX=-0.4; rotationY=0.5;
    aboutOverlay.style.display="none";
    contactsOverlay.style.display="none";
    projectsOverlay.style.display="none";
  });

  // ABOUT
  aboutLink.addEventListener("click", ()=>{
    aboutOverlay.style.display="block";
    contactsOverlay.style.display="none";
    projectsOverlay.style.display="none";
  });
  aboutClose.addEventListener("click", ()=>{
    aboutOverlay.style.display="none";
  });

  // PROJECTS
  projectsLink.addEventListener("click", ()=>{
    projectsOverlay.style.display="block";
    aboutOverlay.style.display="none";
    contactsOverlay.style.display="none";
  });
  projectsClose.addEventListener("click", ()=>{
    projectsOverlay.style.display="none";
  });

  // CONTACTS
  contactsLink.addEventListener("click", ()=>{
    contactsOverlay.style.display="block";
    aboutOverlay.style.display="none";
    projectsOverlay.style.display="none";
  });
  contactsClose.addEventListener("click", ()=>{
    contactsOverlay.style.display="none";
  });
</script>
</body>
</html>
